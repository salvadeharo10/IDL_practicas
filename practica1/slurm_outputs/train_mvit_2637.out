No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
2025-03-14 20:01:28,548 - launch.py - accelerate.commands.launch - WARNING - The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_cpu_threads_per_process` was set to `2` to improve out-of-box performance when training on CPUs
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
Some weights of MobileViTForImageClassification were not initialized from the model checkpoint at apple/mobilevit-small and are newly initialized because the shapes did not match:
- classifier.weight: found shape torch.Size([1000, 640]) in the checkpoint and torch.Size([10, 640]) in the model instantiated
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([10]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/opt/conda/lib/python3.12/site-packages/transformers/models/mobilevit/feature_extraction_mobilevit.py:28: FutureWarning: The class MobileViTFeatureExtractor is deprecated and will be removed in version 5 of Transformers. Please use MobileViTImageProcessor instead.
  warnings.warn(
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
ERROR:2025-03-14 20:07:02 2586:2586 DeviceProperties.cpp:47] gpuGetDeviceCount failed with code 35
Epoch 1, Loss: 2.3059
Epoch 2, Loss: 2.2477
Epoch 3, Loss: 2.2069
Training completed.
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
autograd::engine::evaluate_function: ConvolutionBack...         0.26%     848.580ms        39.12%      128.161s     122.058ms          1050  
                                   ConvolutionBackward0         0.01%      17.667ms        38.82%      127.170s     121.114ms          1050  
                             aten::convolution_backward        38.80%      127.090s        38.82%      127.152s     121.097ms          1050  
                                           aten::conv2d         0.01%      20.864ms        32.76%      107.324s      51.106ms          2100  
                                      aten::convolution         0.01%      24.331ms        16.36%       53.578s      51.027ms          1050  
                                     aten::_convolution         0.00%      16.255ms        16.35%       53.554s      51.004ms          1050  
                               aten::mkldnn_convolution        16.33%       53.502s        16.34%       53.538s      50.988ms          1050  
    autograd::engine::evaluate_function: AddmmBackward0         0.02%      59.817ms        14.52%       47.552s      28.819ms          1650  
                                         AddmmBackward0         0.02%      55.439ms        14.30%       46.845s      28.391ms          1650  
                                               aten::mm        14.26%       46.725s        14.26%       46.727s      14.160ms          3300  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 327.580s

