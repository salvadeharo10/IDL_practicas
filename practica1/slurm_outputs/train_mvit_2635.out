Some weights of MobileViTForImageClassification were not initialized from the model checkpoint at apple/mobilevit-small and are newly initialized because the shapes did not match:
- classifier.weight: found shape torch.Size([1000, 640]) in the checkpoint and torch.Size([10, 640]) in the model instantiated
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([10]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/opt/conda/lib/python3.12/site-packages/transformers/models/mobilevit/feature_extraction_mobilevit.py:28: FutureWarning: The class MobileViTFeatureExtractor is deprecated and will be removed in version 5 of Transformers. Please use MobileViTImageProcessor instead.
  warnings.warn(
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
/opt/conda/lib/python3.12/site-packages/torch/autograd/graph.py:823: UserWarning: aten::layer_norm: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at /pytorch/torch/csrc/autograd/autograd_not_implemented_fallback.cpp:62.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
ERROR:2025-03-14 19:53:03 2532:2532 DeviceProperties.cpp:47] gpuGetDeviceCount failed with code 35
Epoch 1, Loss: 2.3202
Epoch 2, Loss: 2.2691
Epoch 3, Loss: 2.2262
Training completed.
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                        torch_ipex::convolution_forward         0.47%      10.948ms        44.05%        1.029s     979.601us          1050  
                             IPEXConvolutionOp::forward         0.10%       2.387ms        21.90%     511.459ms     974.207us           525  
                            IPEXConvolutionOp::_forward         0.07%       1.732ms        21.80%     509.071ms     969.660us           525  
                   torch_ipex::convolution_forward_impl        21.40%     499.828ms        21.68%     506.174ms     964.141us           525  
autograd::engine::evaluate_function: torch::autograd...         0.38%       8.961ms        20.20%     471.783ms     898.634us           525  
torch::autograd::CppNode<torch_ipex::cpu::IPEXConvol...         0.11%       2.611ms        19.71%     460.298ms     876.757us           525  
                            IPEXConvolutionOp::backward         0.16%       3.809ms        19.60%     457.687ms     871.784us           525  
                       torch_ipex::convolution_backward        18.82%     439.387ms        19.44%     453.878ms     864.530us           525  
    autograd::engine::evaluate_function: AddmmBackward0         0.50%      11.776ms         7.47%     174.416ms     211.413us           825  
autograd::engine::evaluate_function: NativeBatchNorm...         0.23%       5.314ms         6.69%     156.150ms     325.313us           480  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.335s

