Some weights of MobileViTForImageClassification were not initialized from the model checkpoint at apple/mobilevit-small and are newly initialized because the shapes did not match:
- classifier.weight: found shape torch.Size([1000, 640]) in the checkpoint and torch.Size([10, 640]) in the model instantiated
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([10]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/opt/conda/lib/python3.12/site-packages/transformers/models/mobilevit/feature_extraction_mobilevit.py:28: FutureWarning: The class MobileViTFeatureExtractor is deprecated and will be removed in version 5 of Transformers. Please use MobileViTImageProcessor instead.
  warnings.warn(
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Epoch 1, Loss: 2.3013
Epoch 2, Loss: 2.2466
Epoch 3, Loss: 2.1954
[rank0]:[W327 11:36:46.234390864 collection.cpp:992] Warning: Failed to recover relationship between all profiler and kineto events: 132187 vs. 0  reassociated. (function reassociate)
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void magma_sgemmEx_kernel<float, __nv_bfloat16, __nv...         0.00%       0.000us         0.00%       0.000us       0.000us        7.096s        56.00%        7.096s     454.880us           0 b           0 b           0 b           0 b         15600  
void magma_sgemmEx_kernel<float, __nv_bfloat16, __nv...         0.00%       0.000us         0.00%       0.000us       0.000us        1.571s        12.40%        1.571s     103.715us           0 b           0 b           0 b           0 b         15150  
void magma_sgemmEx_kernel<float, __nv_bfloat16, __nv...         0.00%       0.000us         0.00%       0.000us       0.000us        1.394s        11.00%        1.394s      92.202us           0 b           0 b           0 b           0 b         15120  
void at::native::col2im_kernel<c10::BFloat16, float>...         0.00%       0.000us         0.00%       0.000us       0.000us     355.860ms         2.81%     355.860ms      27.458us           0 b           0 b           0 b           0 b         12960  
void at::native::batch_norm_backward_kernel<c10::BFl...         0.00%       0.000us         0.00%       0.000us       0.000us     353.355ms         2.79%     353.355ms     368.078us           0 b           0 b           0 b           0 b           960  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     138.049ms         1.09%     138.049ms     148.440us           0 b           0 b           0 b           0 b           930  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     124.882ms         0.99%     124.882ms       1.041ms           0 b           0 b           0 b           0 b           120  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     123.478ms         0.97%     123.478ms      18.375us           0 b           0 b           0 b           0 b          6720  
void at::native::batch_norm_transform_input_kernel<c...         0.00%       0.000us         0.00%       0.000us       0.000us     114.179ms         0.90%     114.179ms     118.936us           0 b           0 b           0 b           0 b           960  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     113.591ms         0.90%     113.591ms     540.907us           0 b           0 b           0 b           0 b           210  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 11.095s
Self CUDA time total: 12.671s

Training completed.
Training time without initializations: 41.99 seconds.
[rank0]:[W327 11:37:17.705544992 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

real	1m9.579s
user	0m54.480s
sys	0m9.946s
